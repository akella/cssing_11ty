---
title: "font-face оживление"
date: "2009-10-24"
categories: 
  - "xhtmlcss"
  - "design"
---

Последнее время так надоело вставлять свои шрифты на странички, что я решил написать об этом пост. Аккумулированный опыт и последние новости.

Практически, будущее наступило, во всех современных браузерах на данный момент можно вставить нестандартный шрифт на страничку _только с помощью CSS_. (Firefox 3.5+, Chrome 3.0+, Safari 3.1+, Opera 10+, IE 5+)

### Шрифты вообще

Способов за годы веб-разработки придумано множество. И [SIFR](http://wiki.novemberborn.net/sifr3) (шрифты через Flash), которому скоро 5 лет стукнет, и [Cufon](http://wiki.github.com/sorccu/cufon/usage) (шрифты через <canvas>), и всякие другие вариации типа [Typeface](http://typeface.neocracy.org/) (там кстати уже можно выделять и копировать!).

Но еще с прошлого тысячелетия самым крутым способом было конечно просто подключить нужный шрифт на страничку, и написать им текст. Сначала это сделали в Netscape, потом в IE 4.0. А теперь это в грядущем CSS3. По спецификации это принято делать так:

1. @font-face {
2. font-family: Parampampam;
3. src: url(parampampam.ttf);
4. }

И затем использовать это:

1. p { font-family: Parampampam, serif; }

Именно такой подход на данный момент сработает в Firefox 3.5+, Chrome 3.0+, Safari 3.1+, Opera 10+. То есть практически во всех последних версиях браузеров. Они поддерживают .ttf и .otf файлы.

В IE использование своих шрифтов работает еще с версии 4.0. Но, видимо, споткнувшись еще тогда на лицензировании (или по своим иррациональным причинам), они решили создать свой формат для подключаемых файлов Embedded OpenType (.eot). Который и является средоточием геморроя в этом шрифтовом вопросе. В любом случае, подключение там работает примерно также:

1. @font-face {
2. font-family: Parampampam;
3. src: url(parampampam.eot);
4. }

На данном этапе очевидно, если создать этот загадочный .eot файл, то всё будет великолепно, и практически все современные браузеры отобразят наш шрифт.

### Как создать EOT

Давно было известно о специальной программе WEFT от Microsoft. Но мне почему-то никак не удавалось ею воспользоваться, шрифты получавшиеся в результате никогда не работали в ИЕ. Я скидывал это на лицензии или какие-то еще заморочки. Но судя по последним постам, почти ни у кого не получалось заставить ее работать. Программа эта вообще довольно уникальна, стоит лишь пробежаться глазами по [_простому_ скринкасту для конвертации OTF в EOT](http://www.100megspop2.com/tutorials/embeddingfonts/embeddingfonts.htm).

Но буквально за последний месяц появилось еще два варианта, которые нас и спасут.

### Вариант 1: FontForge+[ttf2eot](http://ttf2eot.sebastiankippe.com/)

Появился отличный онлайн сервис ttf2eot для конвертации. Но, если в него просто засунуть первый попавшийся TTF файл, получившийся EOT не будет работать в IE. Чтобы он работал, нужно предварительно почистить атрибуты шрифта. Для этого понадобится [FontForge](http://sourceforge.net/projects/fontforge/files/fontforge-executables/).

Если открыть шрифт в FontForge, мы получим примерно такое окошко:

![FontForge](/pic/fontface/garbage1.png)FontForge

Затем нам нужно будет открыть окно с «Font Info→TTF Names» и удалить _все_ записи отсюда, красные не удалятся, ну и ладно:

![лишние атрибуты](/pic/fontface/cleanup.png)Это окошко находится в меню **Element>Font Info**

Можно посмотреть как это [разжевано в скринкасте](http://snook.ca/archives/html_and_css/screencast-converting-ttf2eot).

После чего просто сохраняем шрифт (File→Generate Fonts) и скармливаем его сервису [ttf2eot](http://ttf2eot.sebastiankippe.com/). Результирующий файл будет работать в IE. В скринкасте кстати, сказано, что надо удалить все атрибуты, и добавить несколько своих. Я просто удалял все, и у меня все работает. Так что можно не заморачиваться.

### Вариант 2: [fontsquierrel](http://www.fontsquirrel.com/fontface/generator)

Однако увидев всю эту мороку из предыдущего варианта, люди ее автоматизировали. Это просто онлайн сервис. Вы загружаете шрифт, он вам генерирует .svg версию шрифта, .eot версию шрифта, и [даже WOFF версию](http://hacks.mozilla.org/2009/10/woff/) (формат для новых Firefox). Вдобавок ко всему, CSS файл с правильным подключением всех этих woff-eot-svg-otf (кошмар какой-то) в @font-face.

Вобщем, на данный момент [просто спасительный сервис](http://www.fontsquirrel.com/fontface/generator), пользуйтесь. Его разработчик активно следит за всеми новостями, и сразу же вносит обновления туда, так что на него можно в каком-то смысле ориентироваться.

### Как внедрить для всех

На данный момент оптимальным принят следующий код:

1. @font-face {
2. font-family: 'Graublau Web';
3. src: url('GraublauWeb.eot');
4. src: local('Graublau Web Regular'), local('Graublau Web'),
5. url('GraublauWeb.otf') format('opentype');
6. }

Подробнее почему именно так, можно [прочитать здесь](http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/). local — означает, что браузер должен проверить есть ли в системе такой шрифт, прежде чем скачивать. _Должен_, но все равно не везде работает. =(

Еще можно подключать шрифты в формате .svg, тогда они отобразятся даже в iPhone.

А буквально на днях [активно продвинулся WOFF](http://hacks.mozilla.org/2009/10/woff/), это «сжатый» truetype который пока будет работать только в Firefox 3.6. Просто чтобы веб-разработчикам было нескучно с OTF, TTF, SVG и EOT.

### Оптимизация

Во-первых файлы шрифта можно просто gzip'ить. [Как показывает опыт](http://www.phpied.com/gzip-your-font-face-files/), можно ужать в два раза. Что вовсе не так мало, при размере порядка 100 килобайт.

Кроме того, если открыть файл шрифта тем же FontForge, то можно увидеть кучу символов, которые вряд ли будут вами использоваться:

![лишние символы в шрифте](/pic/fontface/garbage1.png)Вся эта бяка, которая обычно никому не нужна, занимает такое же кол-во байт, как и нужные всем буквы

Прямо в этом же FontForge ненужные символы можно удалить:

![удалить лишние буквы](/pic/fontface/cleangarbage1.png)Выделить с шифтом и сделать Clear

Благодаря удалению только таких символов, файл для шрифта Myriad у меня уменьшился с 96 килобайт, до 40. Соответственно уменьшается и файл .eot.

### Лицензия

Не все шрифты можно использовать в @font-face. Просто потому что его же можно будет легко скачать, а он может стоить денег. И хотя на практике вряд ли кого-то будут доставать по этому поводу, для популярных сайтов лучше не рисковать. Уже есть сайты-сборники шрифтов доступных для @font-face. Такой список есть на [Webfonts.info](http://webfonts.info/wiki/index.php?title=Fonts_available_for_%40font-face_embedding), например, и вот еще один [отличный ресурс](http://www.theleagueofmoveabletype.com/). (Спасибо Илья!) И время от времени на [разных](http://blog.dotmariusz.net/2009/08/09/free-font-face-fonts-you-might-want-to-use/) [других](http://www.devlounge.net/design/five-fonts-for-font-face) [сайтах](http://www.fontsquirrel.com/).

Кириллических среди них конечно мало, но, пока никто толком не разобрался с этим вопросом, полагаю шрифты можно использовать какие найдете, или просто бесплатные. Вряд ли кого-то засудят за подключение Myriad на свой блог ;)

Предполагается, что WOFF должен решить проблему лицензирования, и что мы сможем использовать на страничках любой шрифт, _которым легально владеем_.

### Ссылки

- [Пример на живом проекте](http://lb.com.ua/article/culture/2009/10/19/11329_oleg_kohan_dazhe_dadut.html) и [искусственный пример](http://cssing.org.ua/examples/fontface/) (с WOFF и SVG сгенерированными на Fontsquirrel)
- [Becoming a Font Embedding Master](http://snook.ca/archives/html_and_css/becoming-a-font-embedding-master) — подборка информации о современном font embedding
- [Лучший способ использования @font-face на данный момент](http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/) и [оптимизация вставки шрифтов](http://paulirish.com/2009/fighting-the-font-face-fout/)
- [Тестирование gzip для шрифтов](http://www.phpied.com/gzip-your-font-face-files/)
- [Where to get web fonts](#) — отличная статья о лицензировании шрифтов и будущем этой проблемы
- [Про WOFF](http://hacks.mozilla.org/2009/10/woff/)
- [@font-face или назад в будущее](http://lovtsevich.com/2009/10/26/font-face-ili-nazad-v-budushhee/)
- [Внедрение шрифтов — EOT и @font-face](http://www.umade.ru/log/2009/07/font-embed-eot-font-face/)
- [Тест 16 кириллических шрифтов доступных для использования](http://lyncis.info/uk/post/274)

Похоже, скоро мы забудем о SIFR и Cufon! Ура!
