---
title: "Адаптивные блоки"
date: "2008-09-17"
categories: 
  - "xhtmlcss"
---

Это когда блоки подстраиваются под ваш размер экрана изменяя ширину и положение. Звучит сложно, выглядит [естественно](http://cssing.org.ua/examples/adaptive/yandtables.html). Далее несколько вариантов. Cтолкнулся в одном из проектов. Было бы обидно оставить добытые знания пылиться бесполезной кипой в мозге. =)

### Простой способ

Задать блокам процентную ширину и min-width:

1. .block{
2. float:left;
3. min-width:200px;
4. max-width:300px;
5. width:25%;
6. }

Вот так они [будут вести себя при изменении ширины окна](http://cssing.org.ua/examples/adaptive/). Не очень совершенный вариант, пространство всё же будет появляться.

Фактически, это означает, что блоки будут резиновыми при ширине экрана от 800 до 1200 пикселей (200\*4 и 300\*4).

### Плюс javascript

Затем я решил слегка улучшить предыдущий способ, подсчитывая джаваскриптом ширину экрана. Будем просто считать количество колонок (n), которое подходит для ширины экрана, и задавать соответствующую процентную ширину (100/n) для каждого из блоков.

Вот такой простой скрипт посчитает нам количество колонок (отрывок):

1. cc=Math.floor(document.documentElement.offsetWidth/(230));  
    // максимальная ширина блока 230
2. document.getElementsByTagName('body')\[0\].className = **'columns' + cc**;  
    // присваиваем нужный класс для body

И примерно такой CSS, задаст им нужную ширину:

1. .columns1 .block{width:100%} //одна колонка
2. .columns2 .block{width:50%} //две колонки
3. .columns3 .block{width:33%} //три колонки
4. ...

Это решение я в итоге и использовал в проекте. [Пример](http://cssing.org.ua/examples/adaptive/blocks.html). Но, пока я пришел к нему, я решил понять как это делают Яндекс и Google.

### Яндекс вариант, таблицы

В своей [выдаче поиска по картинкам](http://images.yandex.ru/yandsearch?rpt=image&text=microformats), Яндекс использует таблицы. И если страничку посжимать, видно как она подстраивается под ваш экран. Разумеется, я раскопал скрипт создающий этот эффект.

Сам код [можно посмотреть в действии тут](http://cssing.org.ua/examples/adaptive/yandtables.html). Вкратце: скрипт получает все ячейки таблицы в массив, из которого затем создает новую таблицу, с нужным количеством колонок. Старая таблица при этом удаляется.

И, это работает. [Пример](http://cssing.org.ua/examples/adaptive/yandtables.html). Авторство скрипта принадлежит [Виталию Харисову](http://vitaly.harisov.name/).

### Google вариант, массив

Только настоящим криптографам под силу расшифровать джаваскрипт на страничке гугла!

Потратив пару часов, я понял, что они еще на сервере генерируют джаваскриптовый массив с содержимым ячеек таблицы. И затем просто работают с самим массивом, не трогая DOM. На Яндексе сделано так же, только массив каждый раз при ресайзе окна создаётся заново, что, впрочем, происходит довольно быстро. Массив выглядит как-то так:

1. dyn.Img(
2. "http:/.../micro.html","",
3. "1UaobYhmShe-WM:",
4. "http://.../micro.png","119","117",
5. "microformats.org MicroFormats logo",
6. "","","337 x 330 - 65k","png","www.andypemberton.com","","",
7. "http://tbn0.google.com/images","1",\[\]
8. );

Google вариант — это быстро, удобно, но не подходит для обычных людей. Вот [страничка с их примером](http://images.google.com/images?q=microformats).

В процессе разборок с кодом google столкнулся с таким вот:

function K(a,c,d,b,e,f,h,k,n,p,M,N,O,P,Q,R,S)

Я нахожу это весьма милым. Хотя это и не писалось руками, а результат сжатия. Все равно мило.

### На... flash

Удивительно, но один [знакомый гениальный дизайнер](http://genn.org), создал флэш-версию этой техники. Она занимает всего пару килобайт, и её оптимизации посвящен [целый пост](http://mega.genn.org/2008/big-flash-collider/). Людям не [любящим flash посвящается](http://cssing.org.ua/examples/adaptive/block.swf). Было бы интересно услышать мнения о производительности примера. Я уже давно убедился, что стереотип чего-то плохого флэш получил незаслуженно. И живой пример [красивого адаптивного флэш-сайта](http://serji.com/).

### В конце

Ссылки на примеры и похожие техники:

- [Адаптивная таблица от Yandex](http://cssing.org.ua/examples/adaptive/yandtables.html) (мой пример) и [её живой вариант](http://images.yandex.ru/yandsearch?rpt=image&text=microformats)
- [Адаптивные флоат-блоки](http://cssing.org.ua/examples/adaptive/) (мой пример), и с [джаваскриптом](http://cssing.org.ua/examples/adaptive/blocks.html) (мой пример)
- [Адаптивная таблица от Google](http://images.google.com/images?q=microformats)
- [Switchy McLayout: An Adaptive Layout Technique](http://www.alistapart.com/articles/switchymclayout) — техника описанная на alistapart
- [Dynamic layouts with adaptive columns](http://www.brandspankingnew.net/archive/2005/12/dynamic_layouts_with_css_javascript.html) — еще один пример адаптивного сайта
- [Пример сайта с динамическим лэйаутом](http://www.themaninblue.com/experiment/ResolutionLayout/) и [статья об этом](http://www.themaninblue.com/writing/perspective/2004/09/21/)
- [Красивый сайт на флэш](http://serji.com/) иллюстрирующий эту же идею

Если у вас были похожие проблемы, буду рад если поделитесь опытом!

За фото спасибо [shorpy.com](http://www.shorpy.com/), за текст лично [Дугласу Адамсу](http://www.douglasadams.com/)!
