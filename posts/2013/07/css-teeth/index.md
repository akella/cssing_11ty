---
title: "Зубчики на CSS"
date: "2013-07-31"
categories: 
  - "fun"
  - "xhtmlcss"
---

Внезапно пост! Небольшой странный чисто webkit трюк который вам пригодится разве что чтобы удивить свою девушку верстальщицу.

### Что будет

Зззубчики:

![](/pic/cssmask/0.png) Интересный эффект чтобы показать вырезки

И вот что [получилось в итоге](/examples/cssmask) или то же на [codepen](http://cdpn.io/cudBi).

### Как это сделать

Будем считать что у нас такой вот HTML:

1. <div class="pic">
2. <img src="pic.jpg">
3. </div>

Ничего такого, просто див.

Первое и самое простое, как это можно сделать, вырезать непрозрачную картинку с фоном и зубчиками, и накладывать поверх нашей. Но тогда станет невозможным такой вариант

![](/pic/cssmask/1.png) Зубчики накладываются друг на друга

### CSS Маски

Да, это существует, хотя и работает пока [далеко не везде](http://caniuse.com/#search=mask) и не полностью. Но к счастью мой проект только для webkit. Да, да, в этом месте можно завидовать.

Как это работает: мы рисуем картинку (gif, png, svg), важно только что у нее есть прозрачные и не очень пиксели-области. Потом «накладываем» на блок и получается:

![](/pic/cssmask/mask.png) Как работают маски в css, иллюстрация от [genn](http://genn.org)

Все что было прозрачного в картинке маски - будет полностью удалено из результата наложения. Полупрозрачные места, соответственно - будут наполовину прозрачны.

Делается в CSS это как-то так:

1. mask-image: url(mask.png); // можно и svg
2. // [или так](http://www.html5rocks.com/en/tutorials/masking/adobe/):
3. mask-image: url(mask.svg) top left / cover; // можно и svg

Можно так поступить и в нашем случае, но у нас зубы с двух сторон. Пришлось бы делать обертку и задавать вторую маску второй картинкой. Если бы не чудесное CSS свойство которое я бы может никогда и не использовал.

### \-webkit-mask-box-image

Эта штука называется страшно и непонятно, но суть ее такая же как у [border-image](http://css-tricks.com/understanding-border-image/). Она условно делит картинку на 9 областей, и растягивает их или повторяет, чтобы создать рамку и уголки вокруг блока. Только нашем случае это не рамка, а маска, вот и вся разница. Вдаваться в теорию не буду, она по ссылке.

А вот такой код сотворит магию:

1. \-webkit-mask-box-image: url(mask.png) 0 3 0 3 repeat;

При этом вот такая картинка mask.png:

![](/pic/cssmask/mask4.png) увеличенная в стотысячмиллионов раз

Числа 0 означают что ширина бордера-маски сверху и снизу равна 0, там у нас гладкая картинка. Два других числа это ширины двух зубчиков, по 3 пикселя.

Но и этого оказалось мне мало, ведь теперь уголки у блоков не стыковались, зубчики соседних элементов не могли войти друг в друга и образовать цельный блок.

![](/pic/cssmask/4.png) Нестыковка

Потому я перерисовал маску в такой вид, сдвинув второй зубец:

![](/pic/cssmask/mask5.png) Вот такая картинка для маски

Это и стало финальным вариантом.

### Обводка

Тут все скучно, несмотря на то как красиво выглядят зубчики, ни `border` ни `outline` ни `box-shadow` не обходят всю границу, выглядит это примерно так:

![](/pic/cssmask/fail.png) Бордер и тень остаются квадратными

Потому пришлось идти дедовским способом известным со времен не работающего в браузерах text-shadow:

1. .pic:before{
2. \-webkit-mask-box-image: url(mask.png) 0 3 0 3 repeat; такая же маска
3. position: absolute;
4. top: -1px;
5. right: -1px;
6. left: -1px;
7. display: block;
8. height: 100%;
9. width: 100%;
10. padding: 1px; // Это важно, делает высоту блока ровно 100% + 2px
11. background: yellow;
12. z-index: 2;

То есть создать псевдоэлемент, точно такой же как эта картинка, с такой же маской, закрасить его каким-то цветом, и растянуть на 1px за пределы блока. Ничего гениального, но в сочетании с маской работает невероятно красиво.

Такая вот маленькая [приятная штука получилась](/examples/cssmask), надеюсь кому-то пригодится =) А вот [codepen](http://cdpn.io/cudBi), поиграться с ней. Я до сих пор не могу удивиться больше, понадобилась всего одна миниатюрная картинка для реализации того что, еще несколько лет назад казалось невозможным.

### Еще почитать на тему

- [Финальный результат](/examples/cssmask/)
- [Пост про clip, там есть фотка красивой модели](http://cssing.org.ua/2008/10/01/clip-it-baby/)
- [На developer.apple.com](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/css/property/-webkit-mask)
- [Как работает border-image](http://css-tricks.com/understanding-border-image/)
- [Еще разные идиотские маски, с анимацией](http://www.html5rocks.com/en/tutorials/masking/adobe/)
