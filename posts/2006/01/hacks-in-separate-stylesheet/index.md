---
title: "CSS для непослушных броузеров"
date: "2006-01-17"
humanDate: "17 Jan, 2006"
permalink: "2006/01/17/hacks-in-separate-stylesheet/"
tags: 
  - "xhtmlcss"
comments: 
  -  author: "пятка"
     id: "2709"
     url: "http://mouldframe.com"
     date: "2006-01-17 17:10:12"
     humandate: "17 Jan, 2006"
     content: | 
       все бы ничего, только цсс-ки, подключенные импортом, не кешируюцца. иешкой, во всяком случае, точно. конечно, для широкого канала и т.д. на это можно забить, но все-таки..)

     email: "dead-proxor@mouldframe.com"

  -  author: "akella"
     id: "2710"
     url: "http://cssing.org.ua"
     date: "2006-01-17 17:50:24"
     humandate: "17 Jan, 2006"
     content: | 
       Вот странно.
       А как узнал? проводил тесты? Или поделись линком - я раньше об этой особенности не слышал... :(

     email: "akella.a@gmail.com"

  -  author: "ganges"
     id: "2718"
     url: ""
     date: "2006-01-18 08:39:17"
     humandate: "18 Jan, 2006"
     content: | 
       Короче, чес это про "не кешируется CSS подключенный @import'ом" галимый, в смысле полный. Только что сам проверил.
       Методика проверки (IE 6 Win SP2)
       1. Удалил все "временные файлы интернета"
       2. Проверил глазами - все чисто
       3. Зашел этим ослом на свой сайт, где все - один сплошной @import
       4. Открыл "временные файлы интернета"
       5. Наблюдаю глазами :) все импорты в кэше.
       6. При выделении одного из файлов в свойствах так и пишет "имя в кэше" и имя файла с индексом.
       
       Юра, тебе скриншот ушел.
       
       2Пятка
       Смени траву, Dude.

     email: "andrey.stefanenko@gmail.com"

  -  author: "Gansik"
     id: "2712"
     url: "http://tagv.com"
     date: "2006-01-17 18:25:33"
     humandate: "17 Jan, 2006"
     content: | 
       Многоуважаемый Akella не любит conditional comments, но тем не менее ими довольно изящно можно подсунуть разные CSS для разных версий IE. Вот что у меня получилось:
       
        &lt;style type="text/css"&gt;@import url("css/all.css") All;&lt;/style&gt;
        &lt;!--[if lt IE 7]&gt;&lt;style type="text/css"&gt;
        @import url("css/all.css");
        @import "css/ie60.css"/**/;
        @import\**"css/ie55.css";
        /*\*//*/@import "css/ie52.css";/**/
        _@import "css/ie50.css";
        &lt;/style&gt;&lt;![endif]--&gt; 
       
       В примере Opera 6.0 тоже отсекается.
       Это все делал, медитируя над http://imfo.ru/csstest/css_hacks/import.php

     email: "gansik@tagv.com"

  -  author: "ganges"
     id: "2713"
     url: ""
     date: "2006-01-17 18:29:34"
     humandate: "17 Jan, 2006"
     content: | 
       2Пятка
       Надо бы аргументировать это хоть как-то для начала :) Или развить тему. Мне это очень интересно, потому что, как и Акелла. я из прилинкованного файла screen.css импортирую составляющие дизайна ala layout.css, visuals.css, textformatting.css
       А ты говоришь "не кешируется" :) Страшно!

     email: "andrey.stefanenko@gmail.com"

  -  author: "akella"
     id: "2714"
     url: "http://cssing.org.ua"
     date: "2006-01-17 18:45:44"
     humandate: "17 Jan, 2006"
     content: | 
       2Gansik: Конечно можно но все равно не люблю - какая то внутренняя антипатия - то есть скорее всего что то моим мозгам не нравится в таком решении. Ну не должно это быть частью HTML кода по моему. Наверно это и мешает.
       
       И я против использования простых хаков. Я бы хотел что бы это всегда было вот таким бредом из кучи символов как в посте. Они его сделали таким не потому что короче не придумали. А для того что бы оно еще и всегда выделялось из общей массы кода. Вряд ли при создании они об этом думали но сейчас точно думают.
       Хотя те кто не имеет ничего против <abbr title="conditional comments">CC</abbr> - на вкус и цвет...
       2Пятка:
       Быть может ты имел ввиду проблему с кешированием при таких линках:
       
       @import "/css/ie.css";
       
       Потому что такая проблема действительно существует. Но она исчезает при иcпользовании:
       
       @import url(/css/ie.css);

     email: "akella.a@gmail.com"

  -  author: "/lekcyc lllumukcyc"
     id: "2717"
     url: "http://co-media.kiev.ua/"
     date: "2006-01-17 19:38:09"
     humandate: "17 Jan, 2006"
     content: | 
       Там есть ещё и другая гадость. Кажется, если ты пытаешся сохранить всю страницу целеком, то оно тебе не сохраняет импортированные CSSы.
       
       Это единственный минус, который можно себе придумать от их использования ;)

     email: "rss@co-media.kiev.ua"

  -  author: "пятка"
     id: "2719"
     url: "http://mouldframe.com"
     date: "2006-01-18 17:09:52"
     humandate: "18 Jan, 2006"
     content: | 
       да. в IE 5.0
       да. еще сервиспак может играть роль. короче - условий много - прислать отчет о багах из архива?:)
       btw, это должно быть в msdn
       
       7 ganges: будем спорить по поводу травы?

     email: "dead-proxor@mouldframe.com"

  -  author: "ganges"
     id: "2724"
     url: ""
     date: "2006-01-18 21:18:53"
     humandate: "18 Jan, 2006"
     content: | 
       Со мной по поводу травы спорить глупо :) Там, откуда я родом, один штакет напрочь убивает шестерых часов на 5.

     email: "andrey.stefanenko@gmail.com"

  -  author: "akella"
     id: "2723"
     url: "http://cssing.org.ua"
     date: "2006-01-18 18:00:02"
     humandate: "18 Jan, 2006"
     content: | 
       Ну... если только в ИЕ 5.0, то уже можно про это забыть - даже на самых "старых" (по аудитории) порталах его доля не превышает 10%. А если еще учесть какие то там другие ограничения на сервис паки - то можно забыть про это.
       
       Это как раз тот момент когда мне хочется сказать что это проблемы пользователя.
       
       Обычно я этого не говорю.
       
       Но за линк на описалово в мсдн был бы оч благодарен.

     email: "akella.a@gmail.com"

  -  author: "пятка"
     id: "2725"
     url: "http://mouldframe.com"
     date: "2006-01-19 00:14:23"
     humandate: "19 Jan, 2006"
     content: | 
       2 akella: безусловно, проблемы пользователя, так же, как и то, диалап у него или выделенная линия, кривые руки или нет etc. в любом случае пример имеет место быть, и отмахнуцца от него низя) линк поищу. последний мсдн еще не смотрел, но, думаю, никто этого фиксать не стал.
       
       2 ganges: к примеру, если ты из африки - это не значит, что у тебя черная кожа. это я к тому, что и про траву могу рассказать тебе намного больше)) а что касаецца проводимых тобою тестов, скринов и т.д. - то у меня, на твоем месте, возникло бы много вопросов, прежде чем я взялся бы опровергать утверждение, например - для начала, версия браузера. потом ос и наличие или отсутствие сервиспака, потом среда, на которой развернут сайт (портал, сервис). затем механизм воспроизведения ошибки. а для начала, как минимум гугли. кстати - тот способ проверки, который ты привел - не канает, ибо не дает возможности сверки хидеров.

     email: "dead-proxor@mouldframe.com"

  -  author: "ganges"
     id: "2728"
     url: ""
     date: "2006-01-19 10:56:27"
     humandate: "19 Jan, 2006"
     content: | 
       Пятка не умничай, плиз, не учи отца и баста. Осел - страшное говно, особенно пятый, об этом знает весь девелоперский мир. Проблемы с кешем существенной НЕТ, иначе был бы хайп, который я бы точно не пропустил и Акелла тоже. И не гони про среду и сервис пак, единственное что может влиять на разное поведение кэша у осла (в нашей епархии) это билд. У меня все кешируется везде и в пятом тоже.

     email: "andrey.stefanenko@gmail.com"

  -  author: "ganges"
     id: "2729"
     url: ""
     date: "2006-01-19 12:31:59"
     humandate: "19 Jan, 2006"
     content: | 
       "кстати - тот способ проверки, который ты привел - не канает, ибо не дает возможности сверки хидеров."
       
       Кстати, что это значит? Должен ли я не верить глазам своим и не считать кэш кэшем, потому что у меня нет информации о HTTP? С чем сверять? Зачем сверять, если кэш был пустой, а стал полным моими импортируемыми файлами?

     email: "andrey.stefanenko@gmail.com"

  -  author: "пятка"
     id: "2730"
     url: "http://mouldframe.com"
     date: "2006-01-19 13:43:30"
     humandate: "19 Jan, 2006"
     content: | 
       2ganges слушай, отец. то что ты говоришь - полная чушь, поскольку свидетельствует только о том, что все что ты делаешь/делал, никогда не имело серьезной промышленной или бизнес основы. в таких случаях у нас говорят - ламо). в связи с этим дальнейший спор с тобой считаю бесполезным. а что касаецца хидеров - есть такая тулза - proxomitron. приценись, посмотри, может узнаешь что-то полезное. существенной проблемы нет, никто и не говорил, что все это смертельно, было указано лишь на существующий факт.

     email: "dead-proxor@mouldframe.com"

  -  author: "akella"
     id: "2731"
     url: "http://cssing.org.ua"
     date: "2006-01-19 14:19:44"
     humandate: "19 Jan, 2006"
     content: | 
       не могу понять о чем вы спорите? о траве? :)
       
       По моему все ясно - если где то оно и не кешируется то только в 5м ИЕ. А это как я уже сказал более чем малозначимо сейчас(я упоминал статистику).
       
       И, Пятка, не вижу никаких причин для иронии по поводу кривых рук и широты канала. Это как раз тот случай когда МОЖНО отмахнутся. 10% юзеров у которых не кешируется пара тройка файлов?(причем 10% как максимум) Какая тут серьезность...
       
       НО, у каждого свои критерии.
       
       Еще раз повторяю не вижу никаких поводов для препирательств. Но линк на точное описание проблемы все бы расставил по местам... Чем попусту спорить лучше бы фактами оперировать.
       
       ЗЫ Будьте корректны.

     email: "akella.a@gmail.com"

  -  author: "ganges"
     id: "2732"
     url: ""
     date: "2006-01-19 14:34:45"
     humandate: "19 Jan, 2006"
     content: | 
       2Пятка
       "было указано лишь на существующий факт."
       1. Да где ж "факт"? Ты не привел ни одной ссылки, предлагал только погуглить
       
       2. Этот сайт читают люди, которые изучают или по крайней мере интересуются CSS. Я думаю, что не надо объяснять, как вредно бывает на начальной стадии изучения чего либо получить дурацкий совет с апломбом типа от "профессионала". Именно поэтому так много табличного дизайна, кстати. Это к вопросу об ответственности в комментариях.
       
       3. Кэширование CSS - одно из важнейших преимуществ этой технологии. Это к вопросу почему я вообще стал комментировать этот чес. 
       
       Бывает всякое, но потрудись, пожалуйста, привести факты или хотя бы аргументы. (ссылки) Мой тест - это аргументированный факт. Если ты считаешь, что я не прав, или мой тест по каким-то причинам несостоятелен - проведи свой или докажи несостоятельность аргументированно, а не ссылаяcь на названия программ (кстати, ты должен знать. что где прокси - там и проблемы с кешированием, может это все из-за того, что ты настроить правильно не смог приблуду?)
       
       Ну и наконец к вопросу о "ламо". Ты кто по профессии? Или кем себя считаешь? Я позволю тебе, как профи, дать свой ламерский совет - познакомь свой сайт с валидаторами.
       working class hero is something to be...

     email: "andrey.stefanenko@gmail.com"

  -  author: "пятка"
     id: "2733"
     url: "http://mouldframe.com"
     date: "2006-01-19 14:48:59"
     humandate: "19 Jan, 2006"
     content: | 
       "линк поищу. последний мсдн еще не смотрел, но, думаю, никто этого фиксать не стал."
       ты читать умеешь? отец))) (вот я, кстати, уже давно отец)
       кроме того, фривольный тон "профессионала" впервые употребил ты, думаю, спорить с этим нет нужды, достаточно посмотреть твои комменты (пост № 7). в таких случаях я отвечаю довольно резко, если скажешь еще что-то подобное - узнаешь как именно:), просто не хотелось бы портить подобными вещами то, ради чего тут все собрались. тулза, которую я тебе предлагал использовать - не прокси сервер и на его работу никак не влияет, но уж если ты об этом заговорил, то должен знать, что, по крайней мере, 70% пользователей ходят в мир именно через проксю. но этот так, просто к слову. моя работа, это моя работа. мой сайт - что ж, тут ты прав. если я не ошибаюсь, проблема с валидацией там только в урлах, ну сори - не сподобился я имплементнуть реврайтинг. btw, написан он был достаточно давно, и сейчас багаж знаний намного больше. это, врочем, особого значения не имеет.

     email: "dead-proxor@mouldframe.com"

  -  author: "пятка"
     id: "2734"
     url: "http://mouldframe.com"
     date: "2006-01-19 14:53:23"
     humandate: "19 Jan, 2006"
     content: | 
       2 akella: 
       кроме того, еще есть один аспект - если уж в приведенных в примере хаках ие 5.0 учитываецца - то почему бы просто не подумать о проблеме кеширования просто как о возможном варианте. или - если доля юзеров невелика - зачем эти хаки вообще?:)
       
       насколько я понимаю, все претензии исчезнут, если я покажу линк какого-нить "гуру" или пример из доки? ок. тогда ждите:)

     email: "dead-proxor@mouldframe.com"

  -  author: "ganges"
     id: "2735"
     url: ""
     date: "2006-01-19 15:43:58"
     humandate: "19 Jan, 2006"
     content: | 
       Хорошо, я принимаю это и да, наверное, сам виноват, пардон, проехали хамство.
       по делу
       
       "70% пользователей ходят в мир именно через проксю. но этот так, просто к слову"
       
       Вот я об этом и говорю - вот это в твоих постах цепляет - это просто базар. Откуда ты взял эту статистику по прокси? Я думаю, что так же прочитал где-то или просто "ляпнул". Линк приведи на какой-нибудь крэдибл ресурс. 
       
       "насколько я понимаю, все претензии исчезнут, если я покажу линк какого-нить “гуру” или пример из доки? ок. тогда ждите:)"
       
       Претензий к тебе насколько я понимаю не было никаких
       CSS гуру можно по пальцам пересчитать, насколько мне известно (просто оченно серьезно я этим интересуюсь, а не потому что "отец") никто из них об этом не писал. 
       Ссылку уже вторые сутки ждем :) Понимаешь? Это важно, как минимум для меня. Это мое хобби и мой хлеб одновременно. И если у меня такой "прогреб" в этом деле, что я не знаю, что @import не кешируется в ИЕ (твой первоначальный и неточный как ты сам сказал коммент) - то для меня очень важно исправить дырку в знаниях. Пока нет ссылки - это Мнение, которое вступает в конфронтацию с моим Знанием и без конкретных доказательств для меня просто чес. К тому же на правиле @import построены куча хаков как раз для ИЕ5
       Все, что прошу - приведи ссылку

     email: "andrey.stefanenko@gmail.com"

  -  author: "пятка"
     id: "2740"
     url: "http://mouldframe.com"
     date: "2006-01-20 16:51:14"
     humandate: "20 Jan, 2006"
     content: | 
       угу. вобщем нашел только про картинки и н только ие5.0. чуть из другой оперы.

     email: "dead-proxor@mouldframe.com"

  -  author: "mcmx"
     id: "2741"
     url: ""
     date: "2006-01-22 13:52:22"
     humandate: "22 Jan, 2006"
     content: | 
       А я вот эту проблемку чуть подругому решил для себя :)
       в CSS я вообще никаких тааких фортелей не использую...
       По той же причине, что и наш уважаемый автор не использует их в HTML - некрасиво и не изящно IMHO :)
       А делаю я это в .htaccess, потому как сервер так или иначе знает, что за зверь к нему стучится :)

     email: "mcmx@mail.ru"

  -  author: "ganges"
     id: "2745"
     url: ""
     date: "2006-01-22 17:07:48"
     humandate: "22 Jan, 2006"
     content: | 
       2mcmx
       Этот метод, как и другие, имеет право на существование. Но вот неужели он более изящен? :) Отредактировав CSS или XHTML тебе еще и .htaccess придется править, ИМХО, что удовольствием никак нельзя назвать.
       
       Я считаю, что самым "правильным" способом бодаться с ослом является, все-таки, выделение хака в отдельный файл, как это делает Akella. Вот только врядли ему удастся "забыть об этом файле навсегда". Потому что выйдет IE7 в массы и у нас начнется настоящий секс. Теоретики начнуть рассуждать, а практикам придется учитывать все версии от 5 до 7. Одних багов поубавится, зато обязательно появятся новые.
       
       Но я отвлекся. Итак - в отдельный файл - это правильно , особенно если хака много (а это не очень хорошо для спокойной жизни). А если хака не очень много - то в CC. 
       И еще, если вы планируете переключение стилей и в разных CSS разный layout (а не скажем цвет только или типографика),
       то правильнее будет отдельный файл
       
       Но в отдельном файле вы не сможете написать Javascript expression (например для эмуляции min- или max-width в IE) - валидатор обругает, а в CC, ИМХО, нет (не проверял)

     email: "andrey.stefanenko@gmail.com"

  -  author: "tobto_"
     id: "2753"
     url: "http://tobto.com.ua"
     date: "2006-01-30 18:18:49"
     humandate: "30 Jan, 2006"
     content: | 
       ну конешо это гуд. но в отдельном проекте - ступор. я щас делаю штуку для радива, типа фэм. сжался плотна. они говорят - давай красоту (флеши, пурга в гифах,...), а я - вот вам ... ф..ак. они конеша дауны, не хавают перфект оф сиss.

     email: "info@eurosong2006.net"

  -  author: "kost"
     id: "2900"
     url: "http://reg.kost.ru"
     date: "2006-03-22 01:46:33"
     humandate: "22 Mar, 2006"
     content: | 
       Спасибо за разъяснение по-русски Mid Pass Filter. 
       
       Но, похоже, он не действует элементы, спозиционированные абсолютно, которые IE5 желает поставить не туда, куда надо (а может, просто уже мне пора спать).

     email: "kost@kost.ru"

  -  author: "akella"
     id: "2901"
     url: "http://cssing.org.ua"
     date: "2006-03-22 12:06:37"
     humandate: "22 Mar, 2006"
     content: | 
       Хм, я как раз недавно использовал - вроде работало... Если б показал пример может все бы прояснилось?

     email: "akella.a@gmail.com"

  -  author: "kost"
     id: "2903"
     url: "http://reg.kost.ru"
     date: "2006-03-22 17:19:06"
     humandate: "22 Mar, 2006"
     content: | 
       По почте пример отправил.

     email: "kost@kost.ru"

  -  author: "Del'ka"
     id: "11111"
     url: "http://anime.kharkov.ua"
     date: "2007-08-17 14:31:05"
     humandate: "17 Aug, 2007"
     content: | 
       Интерестная статья, но я сторонник CC.
       
       А вот в @import url недавно разочаровался обнаружив что при сохранении в ИЕ таких страниц, путь к css не меняется и открыв сохранённую страницу юзер увидит голый макет что очень плохо на мой взгляд.

     email: "delka@anime.kharkov.ua"

  -  author: "akella"
     id: "11114"
     url: "http://cssing.org.ua"
     date: "2007-08-17 17:11:47"
     humandate: "17 Aug, 2007"
     content: | 
       Да, но главное контент остается доступен пользователю, я это так для себя оправдыва. Наверное броузеры должны скоро научиться сохранять импорты...

     email: "akella.a@gmail.com"

layout: "layouts/post.njk"
excerpt: "Конечно все знают кучу всевозможных хаков для ИЕ, и * html и _height:0. Но порой этих хаков становится слишком много и разумнее их все впихнуть в отдельный CSS файл. О том как я это делаю я и написал."
---

Конечно все знают кучу всевозможных хаков для ИЕ, и * html и _height:0. Но порой этих хаков становится слишком много и разумнее их все впихнуть в отдельный CSS файл. О том как я это делаю я и написал.<!--more-->
<h3>Структура CSS файлов</h3>
Если <a href="http://cssing.org.ua/2005/08/24/my-xhtml-template/">кто помнит</a>(пост на эту тему), то я линкую из страниц на один CSS файл master.css. Примерно такого вида:
<ol class="code">
<li>@import url("base.css");</li>
<li>@import url("layout.css");</li>
<li>@import url("fonts.css");</li>
</ol>
Таким образом, если бы я мог добавить conditional comments типа 
<ol class="code">
<li>...</li>
<li>@import url("fonts.css");</li>
<li>{только для ИЕ5}</li>
<li  class="tab">@import url("fonts.css");</li>
<li>{/только для ИЕ5}</li>
</ol>
То я бы был несказанно рад. Сразу оговорюсь что весь этот сыр бор из-за того что мне не очень нравится замусоривать HEAD красивых HTML файлов всякими вот такими штучками:(<a href="http://www.quirksmode.org/css/condcom.html">conditional comments</a>)
<ol class="code">
<li>&lt;!--[if IE]&gt;</li>
<li>&lt;style&gt;</li>
<li class="tab">...</li>
<li>&lt;/style&gt;</li>
<li>&lt;![endif]--&gt;</li>
</ol>
Мне это кажется неэстетичным :). Поэтому я люблю перенести весь этот бред с определением броузеров в малюсенький CSS файл и забыть навсегда. (я о нем по любому забуду, но в HTML он все же будет иногда напоминать о себе)
<h3>Волшебство</h3>
То есть дело лишь за тем, что бы реализовать вот это <strong>{только для ИЕ5}</strong> внутри CSS.

Ну а дальше дело техники. Всем известный <a href="http://tantek.com">Тантек Селик</a> который знает о броузерах не понаслышке :) подарил нам целый арсенал для таких фокусов. 

Вот так выглядит теперь мой CSS файл master.css:
<ol class="code">
<li>@import url("base.css");</li>
<li>@import url("layout.css");</li>
<li>@import url("fonts.css");</li>
<li>/* IE5/Win Only Styles(только для 5го Интеренет Эксплорера под винду)</li>
<li class="tab">   Uses the Mid Pass Filter:</li>
<li class="tab">  http://tantek.com/CSS/Examples/midpass.html</li>
<li>----------------------------------------------- */</li>
<li>@media tty {</li>
<li class="tab"> i{content:"";/*" "*/}} @import url('ie5win.css'); /*";}</li>
<li>}/* */</li>
</ol>
Вот собственно и все. Последний CSS файл увидит только лишь 5ый Эксплорер под виндой. Для меня такое отсеивание самое актуальное. Разумеется существует магия на любой вкус.

Вот так можно "кормить" только  ИЕ5 под Мак:
<ol class="code">
<li>/* IE5/Mac Only Styles</li>
<li class="tab">   Uses the IE5/Mac Band Pass Filter:</li>
<li class="tab">   http://stopdesign.com/examples/ie5mac-bpf/</li>
<li>----------------------------------------------- */</li>
<li>/*\*//*/</li>
<li class="tab">  @import url("ie5mac.css");</li>
<li>/**/</li>
</ol>
Конкретно эти оба кусочка кода я позаимсвовал из CSS файла сайта  <a href="http://stopdesign.com/">Дага Баумана</a>
<h3>Конец</h3>
Для тех кто использует conditional comments это конечно может и не пригодится. Но для меня это изящный способ от них уйти. Добавил себе в темплейт и горя не знаю :)
<h3>Ссылки</h3>
<ul>
<li><a href="http://stopdesign.com/css/050203/master.css">Оба хака в действии</a></li>
<li><a href="http://tantek.com/CSS/Examples/midpass.html">CSS для среднего звена броузеров ИЕ5-5.5 - Mid Pass Filter</a></li>
<li><a href="http://tantek.com/CSS/Examples/highpass.html">CSS только для самых новых броузеров - High Pass FIlter</a></li>
<li><a href="http://tantek.com/CSS/Examples/inlinehpf.html">Inline High Pass Filter</a> - первую половину одного CSS файла будут читать старые броузеры, а вторую только современные.</li>
<li><a href="http://stopdesign.com/examples/ie5mac-bpf/">IE5/Mac Band Pass Filter</a> - как отдать CSS только для ИЕ5 под Мак</li>
</ul>
Был бы рад услышать ваши мнения и идеи по этому вопросу.
